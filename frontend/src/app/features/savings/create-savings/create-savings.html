<div class="create-savings-container">
  <h2>Créer une tirelire</h2>

  <form [formGroup]="form" (ngSubmit)="submit()">
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Nom de la tirelire</mat-label>
      <input matInput formControlName="nom" placeholder="Ex: Vacances 2026">
      <mat-error *ngIf="form.get('nom')?.hasError('required')">Le nom est requis</mat-error>
    </mat-form-field>

    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Description (optionnel)</mat-label>
      <input matInput formControlName="description" placeholder="Ex: Voyage en famille">
    </mat-form-field>

    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Objectif montant (XOF)</mat-label>
      <input matInput type="number" formControlName="objectifMontant" placeholder="Ex: 100000">
    </mat-form-field>

    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Date objectif (optionnel)</mat-label>
      <input matInput type="date" formControlName="dateObjectif">
    </mat-form-field>

    <div class="actions">
      <button mat-button type="button" routerLink="/savings">Annuler</button>
      <button mat-raised-button color="primary" type="submit" [disabled]="loading">
        <mat-icon *ngIf="!loading">visibility</mat-icon>
        <span>{{ loading ? '...' : 'Prévisualiser' }}</span>
      </button>
    </div>
    <div *ngIf="preview" class="preview-section">
      <h3>Prévisualisation</h3>
      <mat-card>
        <mat-card-title>{{ preview.nom }}</mat-card-title>
        <mat-card-content>
          <p *ngIf="preview.description">{{ preview.description }}</p>
          <p><strong>Objectif:</strong> {{ preview.objectifMontant ? (preview.objectifMontant | number) + ' XOF' : 'Non défini' }}</p>
          <p *ngIf="preview.dateObjectif"><strong>Date objectif:</strong> {{ preview.dateObjectif | date:'dd/MM/yyyy' }}</p>
        </mat-card-content>
        <mat-card-actions>
          <button mat-button (click)="cancelPreview()">Modifier</button>
          <button mat-raised-button color="primary" (click)="confirmCreate()" [disabled]="loading">
            <mat-icon *ngIf="!loading">check</mat-icon>
            <span>{{ loading ? 'Création...' : 'Confirmer' }}</span>
          </button>
        </mat-card-actions>
      </mat-card>
    </div>
  </form>

</div>
