<div class="dashboard-container">
  <!-- Header -->
  <div class="app-header">
    <div class="user-info">
      <div class="avatar">{{ user()?.nomComplet?.charAt(0) || 'U' }}</div>
      <div class="greeting">
        <span class="greeting-text">{{ greeting() }}</span>
        <span class="user-name">{{ user()?.nomComplet || 'Utilisateur' }}</span>
      </div>
    </div>
    <div class="header-actions">
      <button mat-icon-button class="notification-btn" routerLink="/notifications">
        <mat-icon>notifications_none</mat-icon>
        <span class="notification-badge"></span>
      </button>
      <button mat-icon-button [matMenuTriggerFor]="menu">
        <mat-icon>more_vert</mat-icon>
      </button>
      <mat-menu #menu="matMenu" class="dashboard-menu">
        <button mat-menu-item routerLink="/profile">
          <mat-icon>person</mat-icon>
          <span>Mon profil</span>
        </button>
        <button mat-menu-item routerLink="/settings">
          <mat-icon>settings</mat-icon>
          <span>Paramètres</span>
        </button>
        <mat-divider></mat-divider>
        <button mat-menu-item (click)="logout()">
          <mat-icon>exit_to_app</mat-icon>
          <span>Déconnexion</span>
        </button>
      </mat-menu>
    </div>
  </div>

  <!-- Balance Card -->
  <div class="balance-card">
    <div class="balance-header">
      <mat-icon>account_balance_wallet</mat-icon>
      <span>Solde disponible</span>
      <button mat-icon-button class="toggle-visibility" (click)="showBalance.set(!showBalance())">
        <mat-icon>{{ showBalance() ? 'visibility' : 'visibility_off' }}</mat-icon>
      </button>
    </div>
    <div class="balance-amount">
      @if (showBalance()) {
        {{ wallet()?.solde | currencyXOF }}
      } @else {
        ••••••••
      }
    </div>
    <div class="balance-divider"></div>
    <div class="savings-row">
      <mat-icon>savings</mat-icon>
      <span>Épargne</span>
      <span class="savings-amount">{{ totalSavings | currencyXOF }}</span>
    </div>
  </div>

  <!-- Quick Actions -->
  <div class="quick-actions-section">
    <h2 class="section-title">Services</h2>
    <div class="quick-actions-grid">
      <div class="quick-action-item" (click)="navigateTo('/transactions/deposit')">
        <div class="action-icon deposit">
          <mat-icon>add_circle</mat-icon>
        </div>
        <span class="action-label">Dépôt</span>
      </div>

      <div class="quick-action-item" (click)="navigateTo('/transactions/withdraw')">
        <div class="action-icon withdraw">
          <mat-icon>remove_circle</mat-icon>
        </div>
        <span class="action-label">Retrait</span>
      </div>

      <div class="quick-action-item" (click)="navigateTo('/transactions/transfer')">
        <div class="action-icon transfer">
          <mat-icon>send</mat-icon>
        </div>
        <span class="action-label">Transfert</span>
      </div>

      <div class="quick-action-item" (click)="navigateTo('/transactions/merchant')">
        <div class="action-icon payment">
          <mat-icon>qr_code_scanner</mat-icon>
        </div>
        <span class="action-label">Paiement</span>
      </div>

      <div class="quick-action-item" (click)="navigateTo('/savings')">
        <div class="action-icon savings">
          <mat-icon>savings</mat-icon>
        </div>
        <span class="action-label">Épargne</span>
      </div>

      <div class="quick-action-item" (click)="navigateTo('/transactions/history')">
        <div class="action-icon scanner">
          <mat-icon>history</mat-icon>
        </div>
        <span class="action-label">Historique</span>
      </div>

      <div class="quick-action-item" (click)="navigateTo('/dashboard/statistics')">
        <div class="action-icon statistics">
          <mat-icon>analytics</mat-icon>
        </div>
        <span class="action-label">Statistiques</span>
      </div>
    </div>
  </div>

  <!-- Recent Transactions -->
  <div class="transactions-section">
    <div class="section-header">
      <h2 class="section-title">Transactions récentes</h2>
      <a class="view-all-link" routerLink="/transactions/history">
        Voir tout
        <mat-icon>arrow_forward</mat-icon>
      </a>
    </div>

    <div class="transactions-list" *ngIf="recentTransactions.length > 0; else noTransactions">
      <div 
        class="transaction-item" 
        *ngFor="let transaction of recentTransactions"
        (click)="viewTransaction(transaction)">
        <div class="transaction-icon" [ngClass]="getTransactionIconClass(transaction.type)">
          <mat-icon>{{ getTransactionIcon(transaction.type) }}</mat-icon>
        </div>
        <div class="transaction-details">
          <div class="transaction-title">{{ getTransactionTitle(transaction) }}</div>
          <div class="transaction-date">{{ transaction.dateCreation | date:'dd/MM/yyyy HH:mm' }}</div>
        </div>
        <div class="transaction-amount" [ngClass]="getAmountClass(transaction.type)">
          {{ getAmountSign(transaction.type) }}{{ transaction.montant | currencyXOF }}
        </div>
      </div>
    </div>

    <ng-template #noTransactions>
      <div class="empty-state">
        <mat-icon>receipt_long</mat-icon>
        <p>Aucune transaction récente</p>
        <button mat-flat-button color="primary" routerLink="/transactions/deposit">
          Faire un dépôt
        </button>
      </div>
    </ng-template>
  </div>

  <!-- Bottom Navigation -->
  <app-bottom-nav></app-bottom-nav>
</div>