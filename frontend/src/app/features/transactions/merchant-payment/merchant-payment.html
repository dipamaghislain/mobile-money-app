<div class="transaction-container">
    <mat-card>
        <mat-card-header>
            <mat-card-title>Paiement Marchand</mat-card-title>
        </mat-card-header>
        <mat-card-content>
            <form [formGroup]="form" (ngSubmit)="onSubmit()">
                @if (error()) {
                <div class="error-message">
                    <mat-icon>error</mat-icon>
                    <span>{{ error() }}</span>
                </div>
                }

                @if (success()) {
                <div class="success-message">
                    <mat-icon>check_circle</mat-icon>
                    <span>{{ success() }}</span>
                </div>
                }

                <mat-form-field appearance="outline" class="full-width">
                    <mat-label>Code Marchand</mat-label>
                    <input matInput type="text" formControlName="codeMarchand" placeholder="Ex: MARCHAND123">
                    <mat-icon matSuffix>store</mat-icon>
                    <mat-error *ngIf="form.get('codeMarchand')?.hasError('required')">
                        Le code marchand est requis
                    </mat-error>
                </mat-form-field>

                <mat-form-field appearance="outline" class="full-width">
                    <mat-label>Montant</mat-label>
                    <input matInput type="number" formControlName="amount" placeholder="Ex: 5000">
                    <span matTextSuffix>XOF</span>
                    <mat-error *ngIf="form.get('amount')?.hasError('required')">
                        Le montant est requis
                    </mat-error>
                    <mat-error *ngIf="form.get('amount')?.hasError('min')">
                        Le montant minimum est de 100 XOF
                    </mat-error>
                </mat-form-field>

                <mat-form-field appearance="outline" class="full-width">
                    <mat-label>Code PIN</mat-label>
                    <input matInput type="password" formControlName="pin" placeholder="****" maxlength="4">
                    <mat-icon matSuffix>lock</mat-icon>
                    <mat-error *ngIf="form.get('pin')?.hasError('required')">
                        Le code PIN est requis
                    </mat-error>
                    <mat-error *ngIf="form.get('pin')?.hasError('pattern')">
                        Le code PIN doit contenir uniquement des chiffres
                    </mat-error>
                </mat-form-field>

                <div class="actions">
                    <button mat-button type="button" routerLink="/dashboard">Annuler</button>
                    <button mat-raised-button color="primary" type="submit" [disabled]="form.invalid || loading()">
                        @if (loading()) {
                        <mat-spinner diameter="20"></mat-spinner>
                        } @else {
                        <span>Payer</span>
                        }
                    </button>
                </div>
            </form>
        </mat-card-content>
    </mat-card>

    <!-- Bottom Navigation -->
    <app-bottom-nav></app-bottom-nav>
</div>