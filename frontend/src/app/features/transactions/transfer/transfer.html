<div class="transaction-container">
    <mat-card class="transfer-card">
        <mat-card-header class="card-header">
            <div class="header-icon">
                <mat-icon>send</mat-icon>
            </div>
            <mat-card-title>Effectuer un transfert</mat-card-title>
            <mat-card-subtitle>Envoyez de l'argent à un autre utilisateur</mat-card-subtitle>
        </mat-card-header>
        <mat-card-content>
            <div class="info-box">
                <mat-icon class="info-icon">info</mat-icon>
                <div class="info-content">
                    <p class="info-title">Informations importantes</p>
                    <ul>
                        <li>Le <strong>numéro de téléphone du destinataire</strong> est requis (10 chiffres)</li>
                        <li>Le <strong>code PIN</strong> est nécessaire pour confirmer la transaction</li>
                        <li>Le montant minimum est de 100 XOF</li>
                    </ul>
                </div>
            </div>
            <form [formGroup]="form" (ngSubmit)="onSubmit()" class="transfer-form">
                @if (error()) {
                <div class="error-message">
                    <mat-icon>error</mat-icon>
                    <span>{{ error() }}</span>
                </div>
                }

                @if (success()) {
                <div class="success-message">
                    <mat-icon>check_circle</mat-icon>
                    <span>{{ success() }}</span>
                </div>
                }
                <mat-form-field appearance="outline" class="full-width">
                    <mat-label>Numéro de téléphone du destinataire</mat-label>
                    <input matInput type="tel" formControlName="telephoneDestinataire" placeholder="Ex: 0612345678">
                    <mat-icon matPrefix>phone</mat-icon>
                    <mat-hint>10 chiffres requis</mat-hint>
                    <mat-error *ngIf="form.get('telephoneDestinataire')?.hasError('required')">
                        Le numéro de téléphone est requis
                    </mat-error>
                    <mat-error *ngIf="form.get('telephoneDestinataire')?.hasError('pattern')">
                        Format invalide (10 chiffres)
                    </mat-error>
                </mat-form-field>

                <mat-form-field appearance="outline" class="full-width">
                    <mat-label>Montant à transférer</mat-label>
                    <input matInput type="number" formControlName="amount" placeholder="Ex: 5000" min="100">
                    <mat-icon matPrefix>attach_money</mat-icon>
                    <span matTextSuffix>XOF</span>
                    <mat-hint>Montant minimum : 100 XOF</mat-hint>
                    <mat-error *ngIf="form.get('amount')?.hasError('required')">
                        Le montant est requis
                    </mat-error>
                    <mat-error *ngIf="form.get('amount')?.hasError('min')">
                        Le montant minimum est de 100 XOF
                    </mat-error>
                </mat-form-field>

                <mat-form-field appearance="outline" class="full-width">
                    <mat-label>Code PIN de sécurité</mat-label>
                    <input matInput type="password" formControlName="pin" placeholder="****" maxlength="4"
                        autocomplete="off">
                    <mat-icon matPrefix>lock</mat-icon>
                    <mat-hint>4 chiffres requis</mat-hint>
                    <mat-error *ngIf="form.get('pin')?.hasError('required')">
                        Le code PIN est requis
                    </mat-error>
                    <mat-error *ngIf="form.get('pin')?.hasError('pattern')">
                        Le code PIN doit contenir uniquement des chiffres
                    </mat-error>
                    <mat-error *ngIf="form.get('pin')?.hasError('minlength')">
                        Le code PIN doit contenir 4 chiffres
                    </mat-error>
                </mat-form-field>

                <div class="actions">
                    <button mat-button type="button" routerLink="/dashboard" class="cancel-btn">
                        <mat-icon>arrow_back</mat-icon>
                        <span>Annuler</span>
                    </button>
                    <button mat-raised-button color="primary" type="submit" [disabled]="form.invalid || loading()"
                        class="submit-btn">
                        @if (loading()) {
                        <mat-spinner diameter="20"></mat-spinner>
                        <span>En cours...</span>
                        } @else {
                        <ng-container matButtonIcon>
                            <mat-icon>send</mat-icon>
                            <span>Envoyer le transfert</span>
                        </ng-container>
                        }
                    </button>
                </div>
            </form>
        </mat-card-content>
    </mat-card>
</div>